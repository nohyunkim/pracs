<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>20ì‚´ì˜ ì§„ì§œ ë§Œì·¨ ì²´í—˜: LAST NIGHT</title>
    <style>
        body { 
            background: #050505; color: white; margin: 0;
            transition: all 1s ease-in-out; height: 100vh;
            display: flex; align-items: center; justify-content: center;
            font-family: 'Pretendard', sans-serif; overflow: hidden;
        }
        .screen { 
            padding: 50px; border: 1px solid #333; border-radius: 30px; 
            text-align: center; background: rgba(20, 20, 30, 0.8);
            box-shadow: 0 0 50px rgba(0,0,0,0.8); backdrop-filter: blur(10px);
            max-width: 500px; width: 90%; position: relative;
        }
        .btn-drink { 
            background: #2ecc71; border: none; padding: 18px 40px; 
            border-radius: 15px; color: #000; font-weight: 800; 
            cursor: pointer; font-size: 1.3rem; transition: 0.3s;
            z-index: 999;
        }
        .msg { font-size: 1.2rem; line-height: 1.8; min-height: 4em; color: #ddd; margin: 20px 0; }
        
        /* ì–´ì§€ëŸ¬ì›€ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes dizzy { 
            0% { transform: rotate(0deg) scale(1); filter: hue-rotate(0deg); }
            33% { transform: rotate(var(--deg)) scale(1.05); filter: hue-rotate(90deg); }
            66% { transform: rotate(calc(var(--deg) * -1)) scale(0.95); filter: hue-rotate(180deg); }
            100% { transform: rotate(0deg) scale(1); filter: hue-rotate(360deg); }
        }

        /* ì…§ë‹¤ìš´ ì• ë‹ˆë©”ì´ì…˜ (12ì” ì—”ë”©ìš©) */
        @keyframes shutdown {
            0% { opacity: 1; transform: scale(1); filter: brightness(1); }
            100% { opacity: 0; transform: scale(0.1); filter: brightness(5); }
        }
    </style>
</head>
<body>

<div id="ssr-app"></div>

<script>
    // 1. ì„œë²„ ë°ì´í„° (State)
    let userState = { shots: 0 };

    // 2. ì˜¤íƒ€ ì œì¡°ê¸° (SSR ì „ìš© í…ìŠ¤íŠ¸ ê°€ê³µ ë¡œì§)
    function makeGlitch(text, level) {
        if (level < 7) return text;
        // 10ì” ì´í›„ì—ëŠ” ê¸€ìê°€ ë” ì‹¬í•˜ê²Œ ê¹¨ì§€ë„ë¡ í™•ë¥  ì¡°ì •
        const rate = level >= 10 ? 0.6 : (level * 0.05);
        return text.split('').map(c => Math.random() < rate ? (Math.random() > 0.5 ? '?' : '!') : c).join('');
    }

    // 3. SSR ì¡°ë¦½ ì—”ì§„ (The Core)
    function buildPage() {
        const s = userState.shots;
        
        // (1) 12ì” ì´ìƒ: ì—”ë”© (ê¸°ì ˆ)
        if (s >= 12) {
            document.body.style.animation = "shutdown 2s forwards";
            setTimeout(() => {
                document.body.innerHTML = "<h1 style='color:white; font-size:3rem;'>ë‹¤ìŒë‚  ì•„ì¹¨... <br><br> ğŸ¥ ì‘ê¸‰ì‹¤ì…ë‹ˆë‹¤.</h1>";
                document.body.style.background = "white";
                document.body.style.color = "black";
                document.body.style.opacity = "1";
            }, 2000);
            return;
        }

        // (2) ë°ì´í„°ì— ë”°ë¥¸ ì„¤ì • (Server Decision)
        let config = {
            deg: "0deg", blur: "0px", bright: "1", grayscale: "0",
            status: "ë©€ì©¡í•¨ ğŸ™‚",
            msg: "ì´ì œ ë§‰ ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ì •ì‹ ì€ ì•„ì§ ë˜ë ·í•©ë‹ˆë‹¤.", bg: "#050505"
        };

        if (s >= 2 && s < 4) {
            config = { deg: "2deg", blur: "1.5px", bright: "1.2", grayscale: "0", status: "ì•Œë”¸ë”¸ ğŸ˜„", msg: "ëª©ì†Œë¦¬ê°€ ì»¤ì§‘ë‹ˆë‹¤. ê¸°ë¶„ì´ ì•„ì£¼ ì¢‹ë„¤ìš”!", bg: "#0a1a0a" };
        } else if (s >= 4 && s < 7) {
            config = { deg: "7deg", blur: "4px", bright: "0.8", grayscale: "0", status: "ë¹„í‹€ê±°ë¦¼ ğŸ˜µâ€ğŸ’«", msg: "ì²œì¥ì´ ì¡°ê¸ˆì”© ë•ë‹ˆë‹¤. í™”ì¥ì‹¤ì´ ì–´ë””ì˜€ì£ ?", bg: "#1a0a0a" };
        } else if (s >= 7 && s < 10) {
            config = { deg: "20deg", blur: "12px", bright: "0.5", grayscale: "0.3", status: "í•„ë¦„ ëŠê¹€ ğŸ«¥", msg: "ëˆ„êµ¬í•œí…Œ ì „í™”í•˜ëŠ” ê±°ì˜ˆìš”? ì •ì‹  ì°¨ë¦¬ì„¸ìš”!", bg: "#1a1a1a" };
        } else if (s >= 10) {
            // 10ì” ì´ìƒ: ë‚´ì¼ì´ ì—†ëŠ” ì‚¬ëŒ 
            config = { deg: "45deg", blur: "22px", bright: "0.25", grayscale: "1", status: "ë‚´ì¼ì´ ì—†ëŠ” ì‚¬ëŒ â˜ ï¸", msg: "ã…‡ã…“...ã…‡ã…•ã„±ã…£ã„±ã…....ã„´ã…œã„±ã…œ....", bg: "#000" };
        }

        // (3) ë²„íŠ¼ ë„ë§ê°€ê¸° ë¡œì§
        let runaway = "";
        if (s >= 7 && s < 10) {
            runaway = `position: fixed; left: ${Math.random()*80}%; top: ${Math.random()*80}%; transform: translate(-50%, -50%);`;
        } else if (s >= 10) {
            // ë²„íŠ¼ì´ íë¦¿í•˜ì§€ë§Œ ì•„ì˜ˆ ì‚¬ë¼ì§€ì§„ ì•Šê²Œ(0.3) ì„¤ì •
            runaway = `position: fixed; left: ${Math.random()*80 + 10}%; top: ${Math.random()*80 + 10}%; opacity: 0.3; transform: scale(0.7) translate(-50%, -50%);`;
        }

        // (4) ìµœì¢… ì¡°ë¦½ (SSR ì´ì–´ë¶™ì´ê¸°)
        const assembledHTML = `
            <div class="screen" style="
                --deg: ${config.deg}; 
                filter: blur(${config.blur}) brightness(${config.bright}) grayscale(${config.grayscale});
                animation: dizzy ${s > 3 ? (s >= 10 ? '0.7s' : '2.5s') : '0s'} infinite ease-in-out;
            ">
                <h2 style="color: #444; letter-spacing: 5px;">${s >= 10 ? 'SYSTEM FAILURE' : 'SOJU SIMULATOR'}</h2>
                <h1 style="font-size: 5rem; margin: 20px 0; color: ${s >= 10 ? 'red' : '#2ecc71'};">${s} ì”</h1>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px; font-size: 1.8rem; margin: 20px 0;">
                    ${config.status}
                </div>
                <p class="msg">${makeGlitch(config.msg, s)}</p>
                
                <button class="btn-drink" 
                    onclick="handleDrink()"
                    style="${runaway}">
                    ${s >= 10 ? 'ê¸°...ì ˆ...?' : 'ì†Œì£¼ í•œ ì” ë”!'}
                </button>
                
                <p style="margin-top: 30px; font-size: 0.8rem; color: #333;">// SSR Status: 1ë³‘ ê¸°ì¤€ ë¶•ê´´ ì‹œìŠ¤í…œ ê°€ë™ ì¤‘</p>
            </div>
        `;

        document.getElementById('ssr-app').innerHTML = assembledHTML;
        document.body.style.background = config.bg;
    }

    function handleDrink() {
        userState.shots += 1;
        buildPage();
    }

    buildPage();
</script>
</body>
</html>
